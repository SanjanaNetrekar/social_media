<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Tags • InstaLite</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4 bg-light">
  <a href="feed.html" class="btn btn-link">← Back to Feed</a>
  <h4>Tags</h4>

  <div class="card p-3 mb-3">
    <input id="tagName" class="form-control mb-2" placeholder="New tag (e.g. travel)">
    <button class="btn btn-primary" onclick="createTag()">Create tag</button>
  </div>

  <div id="tagsList" class="mb-3"></div>
  <div id="tagPosts"></div>

<script>
const api = "http://localhost:3000";
async function createTag(){
  const name = document.getElementById('tagName').value.trim();
  if(!name) return;
  await fetch(api + '/createtag', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ name })});
  document.getElementById('tagName').value = '';
  loadTags();
}
async function loadTags(){
  const r = await fetch(api + '/tags');
  const tags = await r.json();
  document.getElementById('tagsList').innerHTML = (tags||[]).map(t => `<button class="btn btn-outline-secondary m-1" onclick="showTag('${t.name}')">#${t.name}</button>`).join('');
}
async function showTag(name){
  const r = await fetch(api + '/postsbytag/' + encodeURIComponent(name));
  const posts = await r.json();
  document.getElementById('tagPosts').innerHTML = `<h5>Posts tagged #${name}</h5>` + (posts||[]).map(p => `<div class="card p-2 mb-2"><strong>${p.name}</strong><p>${p.content||''}</p></div>`).join('');
}
loadTags();
</script>
</body>
</html>
